syntax = "proto3";

package cityaqrpc;

service CityAQ {
  rpc Cities(CitiesRequest) returns (CitiesResponse) {}
  rpc CityGeometry(CityGeometryRequest) returns (CityGeometryResponse) {}
  rpc EmissionsGrid(EmissionsGridRequest) returns (EmissionsGridResponse) {}
  rpc EmissionsMap(EmissionsMapRequest) returns (EmissionsMapResponse) {}
}

message CitiesRequest {
}

message CitiesResponse {
  // The names of the cities
  repeated string Names = 1;
  // Paths to the file containing the geometry of each city.
  repeated string Paths = 2;
}

message CityGeometryRequest {
  string Path = 1;
}

message CityGeometryResponse {
  repeated Polygon Polygons = 1;
}

message Polygon {
  repeated Path Paths = 1;
}

message Path {
  repeated Point Points = 1;
}

message Point {
  float X = 1;
  float Y = 2;
}

message EmissionsGridRequest {
  string CityName = 1;
  string Path = 2;
}

message EmissionsGridResponse {
  repeated Polygon Polygons = 1;
}

message EmissionsMapRequest {
  string CityName = 1;
  string CityPath = 2;
  Emission Emission = 3;
  string SourceType = 4;
}

enum Emission {
  UNKNOWN_EMISSION = 0;
  PM2_5 = 1;
  NH3 = 2;
  NOx = 3;
  SOx = 4;
  VOC = 5;
}

message EmissionsMapResponse {
  repeated bytes RGB = 1;
  string Legend = 2;
}
